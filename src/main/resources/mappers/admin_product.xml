<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.study.ikmyeongshopteam4.repository.admin.ProductManagementRepository">

    <select id="getCategoryList" resultType="com.study.ikmyeongshopteam4.domain.admin.ProductCategory">
        select
            id,
            category_name
        from
            pdt_category_mst
        order by(id)
    </select>
    <select id="findProductByProductName" resultType="java.lang.Integer">
        select
            count(*)
        from
            pdt_mst
        where
            pdt_name = #{pdtName}
    </select>
    <select id="findProductId" resultType="com.study.ikmyeongshopteam4.domain.Product">
        select
            *
        from
            pdt_mst
        where
            pdt_name = #{pdtName}
    </select>
    <select id="findProductDesign" resultType="java.lang.Integer">
        select
            count(*)
        from
            pdt_dtl
        where
            pdt_id = #{pdtId}
    </select>

    <insert id="saveProduct" parameterType="com.study.ikmyeongshopteam4.domain.Product" useGeneratedKeys="true" keyProperty="id">
        insert into
            pdt_mst
        values (
            0,
            #{pdt_name},
            #{category_id},
            #{pdt_price},
            now(),
            now()
        );
    </insert>
    <insert id="saveProductDetail">
        insert into
            pdt_dtl
        values (
            0,
            #{pdt_id},
            #{pdt_design},
            #{pdt_stock},
            now(),
            now()
        );
    </insert>
    <insert id="saveImgFiles" parameterType="java.util.List">
        insert into
            pdt_image_mst
        values
            <foreach collection="list" item="img" separator=",">
                (
                0,
                #{img.pdt_id},
                #{img.origin_name},
                #{img.save_name},
                now(),
                now()
                )
            </foreach>
    </insert>
</mapper>